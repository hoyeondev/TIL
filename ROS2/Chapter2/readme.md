# Chapter 2: ROS 2 통신 기초 - 토픽, 메시지, 서비스, 액션


## 📚 개념 요약

### 🧩 노드(Node)
노드는 ROS2 시스템의 가장 기본 단위다.
하나의 노드는 특정 기능(예: 센서 데이터 수집, 제어, 경로 계획 등)을 수행한다.

🔹 예시
- `lidar_node`: LiDAR 센서 데이터를 수집
- `navigation_node`: 지도 기반 경로를 계산
- `motor_control_node`: 모터에 속도 명령 전달

노드는 하나의 독립된 실행 단위이며,
서로 통신하기 위해 토픽(Topic), 서비스(Service), 액션(Action) 을 이용한다.

### 📤 Topic (토픽)
ROS2에서 노드 간 실시간 데이터를 주고받는 가장 기본적인 통신 방식이 토픽 통신이다.
- **비동기 통신**
- 발행자(Publisher)가 메시지를 보내고, 구독자(Subscriber)가 받음
- 다수의 발행자/구독자 허용
- 실시간 센서 데이터, 상태 정보 등에 적합

| 구성 요소          | 역할                       |
| -------------- | ------------------------ |
| **Topic**      | 노드 간 메시지를 주고받는 **통신 채널** |
| **Publisher**  | 토픽에 메시지를 **보내는 노드**      |
| **Subscriber** | 토픽에서 메시지를 **받는 노드**      |

> 💬 예시
> 
> - `lidar_node` → /`scan` 토픽에 LaserScan 메시지를 발행 (Publisher)
>
> - `mapping_node` → /`scan` 토픽을 구독하여 데이터를 받아서 지도 생성 (Subscriber)
>

```bash
# 토픽 목록 확인
ros2 topic list

# 토픽 메시지 내용 확인
ros2 topic echo /scan

# 토픽의 타입 확인
ros2 topic type /cmd_vel

```

### 🛠️ Service (서비스)
- 요청(Request)과 응답(Response) 구조의 동기 통신
- 예: "배터리 상태 알려줘" → "현재 배터리 82%입니다"

- **동기 통신**
- 요청(Request) → 응답(Response) 구조
- 호출 시점에만 통신 발생
- 로봇 초기화, 특정 작업 지시 등에 사용

### ⏱️ Action (액션)

- **비동기 + 피드백 + 취소 지원**
- 장시간 수행되는 작업에 적합 (예: 목적지까지 이동)
- 구조: Goal → Feedback → Result → Cancel
- 중간 진행 상태를 계속 보고받을 수 있음
- 예: “이 좌표로 이동해!” → 중간 진행률 40% → 도착 완료

---

## 🧩 메시지 타입 구조

| 유형     | 파일 확장자 | 예시 타입                       |
|----------|--------------|----------------------------------|
| Topic    | `.msg`       | `std_msgs/String`, `geometry_msgs/Twist` |
| Service  | `.srv`       | `turtlesim/srv/Spawn`           |
| Action   | `.action`    | `nav2_msgs/action/NavigateToPose` |


## 🔄 통신 구조 비교

|항목 |Topic |Service |Action |
|----------|--------------|-------------------|---------------|
|통신 방식|단방향 |비동기	요청-응답 |동기	목표 전송 + 피드백 + 완료| 비동기|
|사용 예|센서값 전송,상태 방송|	초기화 명령,설정값 요청|목표 지점 이동,긴 작업 수행 |
|장점|빠름,실시간 |직관적인 요청 응답|진행률 추적,취소 가능|
